$(document).ready(function(){
    var $users = $('#users');

    $users.on('click', '.delete', function(){
        var id = $(this).data('id');
        removeUser(id);
    });
});

function removeUser(id){
    $.ajax({
        url: '/users/' + id,
        type: 'DELETE'
    }).done(function(response, textStatus, jqXHR){
        console.log('Deleted user ' + id);
    }).fail(function( jqXHR, textStatus, errorThrown ) {
        console.log(jqXHR, textStatus, errorThrown);
    }).always(function(){
        getAllUsers();
    });
}

function getAllUsers(){
    $.ajax({
        url: '/users',
        type: 'GET'
    }).done(function(response, textStatus, jqXHR){
        console.log('Retrieved ' + response.length + ' users!');
    }).fail(function( jqXHR, textStatus, errorThrown ) {
        console.log(jqXHR, textStatus, errorThrown);
    }).always(function(){
        console.log('Ajax complete');
    });
}